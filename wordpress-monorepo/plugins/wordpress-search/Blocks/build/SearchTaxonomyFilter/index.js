(()=>{"use strict";const e=window.wp.blocks,s=window.wp.i18n,t=window.wp.data,o=window.wp.components,n=window.wp.blockEditor,r=window.wp.element,i=window.ReactJSXRuntime,l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"wordpress-search/search-taxonomy-filter","version":"1.0.0","title":"Taxonomy Filter","category":"search","icon":"filter","description":"A modular search taxonomy filter block that connects to the search page template","attributes":{"selectedTaxonomies":{"type":"array","default":[],"items":{"type":"string"}}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","viewStyle":"file:./view.css","viewScript":"file:./view.js","render":"file:./render.php","style":"file:./view.css","dependencies":["wp-api-fetch","wp-url","wp-components","wp-element","wp-i18n"]}');(0,e.registerBlockType)(l.name,{...l,edit:function({attributes:e,setAttributes:l}){const{selectedTaxonomy:a,selectedTaxonomies:c}=e,d=void 0!==c?c:a?[a]:[];(0,r.useEffect)((()=>{a&&void 0===c&&(console.log("Migrating old selectedTaxonomy to selectedTaxonomies:",a),l({selectedTaxonomies:[a]}))}),[]);const{taxonomies:p}=(0,t.useSelect)((e=>{const{getTaxonomies:s}=e("core");return{taxonomies:s({per_page:-1,context:"view"})||[]}}),[]),m=(p||[]).filter((e=>!!e&&!!e.name)).map((e=>{if(!e.types||0===e.types.length){const s=e.object_type||[];if(0===s.length)return null;e.types=s}const t=e.labels?.singular_name||e.name||(0,s.__)("Unknown","wordpress-search"),o=e.types[0];return{label:`${o.charAt(0).toUpperCase()+o.slice(1)}: ${t.charAt(0).toUpperCase()+t.slice(1)}`,value:`${e.types[0]}:${e.name}`}})).filter(Boolean);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.InspectorControls,{children:(0,i.jsx)(o.PanelBody,{title:(0,s.__)("Taxonomy Filter Settings","wordpress-search"),initialOpen:!0,children:(0,i.jsxs)("div",{className:"taxonomy-filter-settings",children:[(0,i.jsx)("p",{className:"taxonomy-filter-settings__description",children:(0,s.__)("Select one or more taxonomies to create filters for:","wordpress-search")}),m.length>0?m.map((e=>(0,i.jsx)(o.CheckboxControl,{label:e.label,checked:d.includes(e.value),onChange:s=>((e,s)=>{console.log("Taxonomy change:",e,s,"Current:",d);const t=s?[...d,e]:d.filter((s=>s!==e));console.log("New selected taxonomies:",t),l({selectedTaxonomies:t})})(e.value,s)},e.value))):(0,i.jsx)("p",{className:"taxonomy-filter-settings__loading",children:(0,s.__)("Loading taxonomies...","wordpress-search")})]})})}),(0,i.jsx)("div",{...(0,n.useBlockProps)(),children:(0,i.jsxs)("div",{className:"taxonomy-filter-preview",children:[(0,i.jsxs)("div",{className:"taxonomy-filter-preview__header",children:[(0,i.jsx)("h4",{children:(0,s.__)("Taxonomy Filter","wordpress-search")}),(0,i.jsx)("p",{className:"taxonomy-filter-preview__description",children:d&&d.length>0?(0,s.__)("Selected:","wordpress-search")+(d&&0!==d.length?d.map((e=>{const t=m.find((s=>s.value===e));return t?t.label:(0,s.__)("Unknown taxonomy","wordpress-search")})).join(", "):(0,s.__)("No taxonomies selected","wordpress-search")):(0,s.__)("Configure taxonomies in the block settings â†’","wordpress-search")})]}),d&&d.length>0&&(0,i.jsx)("div",{className:"taxonomy-filter-preview__content",children:(0,i.jsx)("div",{className:"taxonomy-filter-preview__placeholder",children:(0,i.jsx)("p",{children:(0,s.__)("Filter options will appear here on the frontend","wordpress-search")})})})]})})]})},deprecated:[{attributes:{selectedTaxonomy:{type:"string",default:""}},save:()=>null,migrate:e=>{const{selectedTaxonomy:s}=e||{};return{selectedTaxonomies:s?[s]:[]}}}]})})();