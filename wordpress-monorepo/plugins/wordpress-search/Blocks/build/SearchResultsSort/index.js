(()=>{"use strict";var e={n:s=>{var r=s&&s.__esModule?()=>s.default:()=>s;return e.d(r,{a:r}),r},d:(s,r)=>{for(var t in r)e.o(r,t)&&!e.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:r[t]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.blocks,r=window.wp.i18n,t=window.wp.components,l=window.wp.blockEditor,a=window.wp.apiFetch;var o=e.n(a);const i=window.wp.element,c=window.ReactJSXRuntime,n=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"wordpress-search/searchresultssort","version":"1.0.0","title":"Search Results Sort","category":"search","icon":"sort","description":"A sort control for search results that sorts by relevance_date custom field","attributes":{"selectedMetaFields":{"type":"array","default":[]}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","viewStyle":"file:./view.css","viewScript":"file:./view.js","render":"file:./render.php","style":"file:./view.css","dependencies":["wp-api-fetch","wp-components","wp-element","wp-i18n"]}');(0,s.registerBlockType)(n.name,{...n,edit:function({attributes:e,setAttributes:s}){const{selectedMetaFields:a}=e,[n,d]=(0,i.useState)([]),[p,h]=(0,i.useState)(!0),u=e=>{let s=e;if(e.includes(":")){const r=e.split(":");s=r[r.length-1]}let r=s.replace(/_/g," ");r=r.replace(/\b\w/g,(e=>e.toUpperCase()));const t={"Sort Relevance":"Sort Relevance","Document File Name":"File Name","Document File Url":"File URL","Document File Size":"File Size","Document File Type":"File Type","Post Date":"Publication Date","Page Order":"Page Order",This2:"This 2"};return t[r]?t[r]:r},w=async()=>{h(!0);try{const e=await o()({path:"/wordpress-search/v1/meta-fields",method:"GET"});e&&e.length>0?d(e):d([])}catch(e){d([])}finally{h(!1)}};return(0,i.useEffect)((()=>{w()}),[]),(0,i.useEffect)((()=>{0===n.length&&w()}),[a,n.length]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.InspectorControls,{children:(0,c.jsxs)(t.PanelBody,{title:(0,r.__)("Available Sort Fields","wordpress-search"),initialOpen:!0,children:[(0,c.jsx)("p",{className:"components-base-control__help",children:(0,r.__)("Select which metadata fields should be available for sorting on the frontend. Fields are automatically refreshed.","wordpress-search")}),!p&&0===n.length&&(0,c.jsx)("div",{style:{padding:"12px",background:"#f0f0f0",borderRadius:"4px",marginBottom:"8px",textAlign:"center"},children:(0,c.jsx)("p",{style:{margin:0,fontSize:"14px",color:"#666"},children:(0,r.__)("No metadata fields found. Check that your posts have custom metadata.","wordpress-search")})}),p&&(0,c.jsx)("p",{children:(0,r.__)("Loading available fields…","wordpress-search")}),!p&&n.map((e=>(0,c.jsx)(t.CheckboxControl,{label:u(e.value),checked:a.includes(e.value),onChange:r=>((e,r)=>{const t=r?[...a,e]:a.filter((s=>s!==e));s({selectedMetaFields:t})})(e.value,r)},e.value))),0===a.length&&!p&&(0,c.jsx)("div",{className:"components-notice components-notice--warning",children:(0,c.jsx)("p",{children:(0,r.__)("No fields selected. Users will not see any sort options.","wordpress-search")})})]})}),(0,c.jsx)("div",{...(0,l.useBlockProps)(),children:(0,c.jsx)("div",{className:"wp-block-wordpress-search-searchresultssort",children:(0,c.jsx)("div",{className:"search-results-sort",children:(0,c.jsxs)("div",{className:"search-results-sort__controls",children:[(0,c.jsxs)("div",{className:"search-results-sort__field-group",children:[(0,c.jsx)("label",{className:"search-results-sort__label",htmlFor:"preview-field-select",children:(0,r.__)("Sort by field:","wordpress-search")}),(0,c.jsxs)("select",{id:"preview-field-select",className:"search-results-sort__field-select",disabled:!0,style:{opacity:.7},children:[(0,c.jsx)("option",{children:(0,r.__)("Select a field to sort by…","wordpress-search")}),a.map((e=>(0,c.jsx)("option",{value:e,children:u(e)},e)))]})]}),a.length>0&&(0,c.jsxs)("div",{className:"search-results-sort__order-group",children:[(0,c.jsx)("label",{className:"search-results-sort__label",htmlFor:"preview-order-select",children:(0,r.__)("Order:","wordpress-search")}),(0,c.jsxs)("select",{id:"preview-order-select",className:"search-results-sort__order-select",disabled:!0,style:{opacity:.7},children:[(0,c.jsx)("option",{value:"off",children:(0,r.__)("Default (No sorting)","wordpress-search")}),(0,c.jsx)("option",{value:"desc",children:(0,r.__)("Newest first","wordpress-search")}),(0,c.jsx)("option",{value:"asc",children:(0,r.__)("Oldest first","wordpress-search")})]})]})]})})})})]})}})})();