{"version":3,"file":"BreadCrumb/view.js","mappings":"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","sources":["webpack://design-system-navigation-block/./src/BreadCrumb/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function() {\n    const breadcrumbs = document.querySelectorAll('.wp-block-design-system-wordpress-plugin-breadcrumb');\n    \n    // Get post ID from body class\n    function getPostId() {\n        const bodyClasses = document.body.className.split(' ');\n        const pageIdClass = bodyClasses.find(className => className.startsWith('page-id-'));\n        return pageIdClass ? pageIdClass.replace('page-id-', '') : null;\n    }\n\n    // Get the site URL path from the current location\n    function getSiteBasePath() {\n        // Get WordPress site URL from a meta tag or similar source\n        const wpJsonScripts = document.querySelectorAll('script[src*=\"/wp-json/\"]');\n        if (wpJsonScripts.length > 0) {\n            const scriptSrc = wpJsonScripts[0].src;\n            const wpJsonIndex = scriptSrc.indexOf('/wp-json/');\n            if (wpJsonIndex !== -1) {\n                return scriptSrc.substring(0, wpJsonIndex);\n            }\n        }\n\n        // Fallback: use window.location.origin\n        return window.location.origin;\n    }\n\n    function sanitizeTitle(title) {\n        if (!title) return '';\n        if (typeof title === 'string') return title;\n        if (title.rendered) return title.rendered;\n        return '';\n    }\n\n    breadcrumbs.forEach(async function(breadcrumb) {\n        const container = breadcrumb.querySelector('.dswp-block-breadcrumb__container');\n        \n        try {\n            let postId = breadcrumb.getAttribute('data-page-id');\n            \n            if (!postId || isNaN(postId)) {\n                postId = getPostId();\n                if (!postId) {\n                    console.warn('Could not determine current page ID');\n                    return;\n                }\n            }\n\n            // Build the correct API URL using the base path\n            const apiUrl = `${getSiteBasePath()}/wp-json/wp/v2/pages/${postId}`;\n            \n            const response = await fetch(apiUrl);\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n            const currentPage = await response.json();\n            \n            if (!currentPage?.title?.rendered) {\n                throw new Error('Invalid page data received');\n            }\n\n            // Get the settings from the block's data attributes\n            const dividerType = breadcrumb.getAttribute('data-divider-type') || 'slash';\n            const currentAsLink = breadcrumb.getAttribute('data-current-as-link') === 'true';\n            const divider = dividerType === 'chevron' ? ' > ' : ' / ';\n\n            // Build hierarchy\n            const hierarchy = [];\n            let page = currentPage;\n\n            // Add current page\n            if (page?.title) {\n                hierarchy.unshift({\n                    title: sanitizeTitle(page.title),\n                    url: page.link || '#',\n                    id: page.id\n                });\n            }\n\n            // Get ancestors\n            while (page?.parent) {\n                const parentApiUrl = `${getSiteBasePath()}/wp-json/wp/v2/pages/${page.parent}`;\n                const parentResponse = await fetch(parentApiUrl);\n                if (!parentResponse.ok) break;\n                \n                page = await parentResponse.json();\n                \n                if (page?.title) {\n                    hierarchy.unshift({\n                        title: sanitizeTitle(page.title),\n                        url: page.link || '#',\n                        id: page.id\n                    });\n                }\n            }\n\n            // Build breadcrumb HTML\n            container.innerHTML = hierarchy.map((item, index) => {\n                const isLast = index === hierarchy.length - 1;\n                const title = sanitizeTitle(item.title);\n                \n                if (isLast) {\n                    // Use the currentAsLink setting\n                    return currentAsLink ? \n                        `<a href=\"${item.url}\" class=\"current-page-link\">${title}</a>` :\n                        `<span class=\"current-page\">${title}</span>`;\n                }\n                \n                // Use the correct divider\n                return `\n                    <a href=\"${item.url}\">${title}</a>\n                    <span class=\"separator\">${divider}</span>\n                `;\n            }).join('');\n\n            // After content is rendered, add the loaded class\n            container.classList.add('is-loaded');\n        } catch (error) {\n            console.error('Error building breadcrumb:', error);\n            container.classList.add('is-loaded'); // Still add class even on error\n            container.innerHTML = '<span class=\"breadcrumb-error\">Navigation</span>';\n        }\n    });\n});\n"],"names":["document","addEventListener","breadcrumbs","querySelectorAll","getPostId","bodyClasses","body","className","split","pageIdClass","find","startsWith","replace","getSiteBasePath","wpJsonScripts","length","scriptSrc","src","wpJsonIndex","indexOf","substring","window","location","origin","sanitizeTitle","title","rendered","forEach","breadcrumb","container","querySelector","postId","getAttribute","isNaN","console","warn","apiUrl","response","fetch","ok","Error","status","currentPage","json","dividerType","currentAsLink","divider","hierarchy","page","unshift","url","link","id","parent","parentApiUrl","parentResponse","innerHTML","map","item","index","isLast","join","classList","add","error"],"sourceRoot":""}