{"version":3,"file":"BreadCrumb/view.js","mappings":"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","sources":["webpack://design-system-navigation-block/./src/BreadCrumb/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function() {\n    const breadcrumbs = document.querySelectorAll('.wp-block-design-system-wordpress-plugin-breadcrumb');\n    \n    // Get post ID from body class\n    function getPostId() {\n        const bodyClasses = document.body.className.split(' ');\n        const pageIdClass = bodyClasses.find(className => className.startsWith('page-id-'));\n        return pageIdClass ? pageIdClass.replace('page-id-', '') : null;\n    }\n\n    function sanitizeTitle(title) {\n        if (!title) return '';\n        if (typeof title === 'string') return title;\n        if (title.rendered) return title.rendered;\n        return '';\n    }\n\n    breadcrumbs.forEach(async function(breadcrumb) {\n        try {\n            const postId = getPostId();\n            if (!postId) {\n                console.warn('Could not determine current page ID');\n                return;\n            }\n\n            // Use the public endpoint instead of the edit context\n            const response = await fetch(`/wp-json/wp/v2/pages/${postId}`);\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}`);\n            }\n            const currentPage = await response.json();\n            \n            if (!currentPage?.title?.rendered) {\n                throw new Error('Invalid page data received');\n            }\n\n            // Get settings from data attributes\n            const dividerType = breadcrumb.dataset.dividerType || 'slash';\n            const currentAsLink = breadcrumb.dataset.currentAsLink === 'true';\n            const divider = dividerType === 'chevron' ? ' > ' : ' / ';\n\n            // Build hierarchy\n            const hierarchy = [];\n            let page = currentPage;\n\n            // Add current page\n            if (page?.title) {\n                hierarchy.unshift({\n                    title: sanitizeTitle(page.title),\n                    url: page.link || '#',\n                    id: page.id\n                });\n            }\n\n            // Get ancestors\n            while (page?.parent) {\n                const parentResponse = await fetch(`/wp-json/wp/v2/pages/${page.parent}`);\n                if (!parentResponse.ok) break;\n                \n                page = await parentResponse.json();\n                \n                if (page?.title) {\n                    hierarchy.unshift({\n                        title: sanitizeTitle(page.title),\n                        url: page.link || '#',\n                        id: page.id\n                    });\n                }\n            }\n\n            // Build breadcrumb HTML\n            const container = breadcrumb.querySelector('.dswp-block-breadcrumb__container');\n            if (!container) {\n                throw new Error('Breadcrumb container not found');\n            }\n\n            container.innerHTML = hierarchy.map((item, index) => {\n                if (!item?.title) return '';\n                \n                const isLast = index === hierarchy.length - 1;\n                const title = item.title\n                    .replace(/&([^;]+);/g, (s, entity) => {\n                        const entities = {\n                            'amp': '&',\n                            'lt': '<',\n                            'gt': '>',\n                            'quot': '\"',\n                            'apos': \"'\",\n                            '#39': \"'\"\n                        };\n                        return entities[entity] || s;\n                    })\n                    .replace(/<[^>]*>/g, '');\n                \n                if (isLast) {\n                    return currentAsLink ? \n                        `<a href=\"${item.url}\" class=\"current-page-link\">${title}</a>` :\n                        `<span class=\"current-page\">${title}</span>`;\n                }\n                \n                return `\n                    <a href=\"${item.url}\">${title}</a>\n                    <span class=\"separator\">${divider}</span>\n                `;\n            }).join('');\n\n        } catch (error) {\n            console.error('Error building breadcrumb:', error);\n            // Optionally show a fallback UI\n            const container = breadcrumb.querySelector('.dswp-block-breadcrumb__container');\n            if (container) {\n                container.innerHTML = '<span class=\"breadcrumb-error\">Navigation</span>';\n            }\n        }\n    });\n});\n"],"names":["document","addEventListener","breadcrumbs","querySelectorAll","getPostId","bodyClasses","body","className","split","pageIdClass","find","startsWith","replace","sanitizeTitle","title","rendered","forEach","breadcrumb","postId","console","warn","response","fetch","ok","Error","status","currentPage","json","dividerType","dataset","currentAsLink","divider","hierarchy","page","unshift","url","link","id","parent","parentResponse","container","querySelector","innerHTML","map","item","index","isLast","length","s","entity","entities","join","error"],"sourceRoot":""}