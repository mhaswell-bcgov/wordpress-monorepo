document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("#main-content")||document.querySelector("main")||document.querySelector(".content-area");if(!e)return;const t=Array.from(e.querySelectorAll("h2[id], h3[id]"));if(t.length<2)return;const n=document.createElement("aside");n.className="dswp-in-page-nav",n.innerHTML=`\n        <div class="nav-header">\n            <div class="nav-title">\n                <h4>On this page</h4>\n            </div>\n            <button type="button" class="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false"></button>\n        </div>\n        <ul class="nav-links">\n            ${t.map((e=>`\n                <li>\n                    <a href="#${e.id}" data-heading-id="${e.id}">\n                        ${e.textContent}\n                    </a>\n                </li>\n            `)).join("")}\n        </ul>\n    `;const a=document.createElement("div");a.className="dswp-nav-content-container",e.parentNode.insertBefore(a,e),a.appendChild(n),a.appendChild(e);const i=()=>{const e=n.offsetHeight+8,a=window.scrollY+e+.2*window.innerHeight;window.innerWidth<=768&&window.scrollY<50?(n.classList.add("is-expanded"),o.setAttribute("aria-expanded","true")):n.hasAttribute("data-manual-expanded")||(n.classList.remove("is-expanded"),o.setAttribute("aria-expanded","false"));let i=null;for(const e of t){if(!(e.getBoundingClientRect().top+window.scrollY<a))break;i=e}n.querySelectorAll("a").forEach((e=>{const t=i&&e.getAttribute("data-heading-id")===i.id;e.classList.toggle("dswp-current",t),e.closest("li").classList.toggle("current",t)}))},o=n.querySelector(".nav-toggle");let d;o.addEventListener("click",(e=>{e.stopPropagation();const t=n.classList.toggle("is-expanded");o.setAttribute("aria-expanded",t?"true":"false"),t?n.setAttribute("data-manual-expanded",""):n.removeAttribute("data-manual-expanded")})),n.querySelectorAll("a").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const a=e.getAttribute("href").substring(1),i=document.getElementById(a);if(!i)return;const o=n.offsetHeight+dswpInPageNav.options.scroll_offset;window.scrollTo({top:i.getBoundingClientRect().top+window.scrollY-o,behavior:"smooth"}),history.pushState(null,null,`#${a}`),n.removeAttribute("data-manual-expanded"),n.classList.remove("is-expanded")}))})),window.addEventListener("scroll",(()=>{d&&window.cancelAnimationFrame(d),d=window.requestAnimationFrame(i)})),i()}));